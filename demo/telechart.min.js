!function(){var e,t,i,a,l,n,o,r,d,s,h,c={},m={};let f=null,p=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},w=()=>{let e=!1;try{let t={get passive(){e=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){return!1}return e},u=()=>{let e=w();f.passiveSupported=e,f.passive=!!e&&{passive:!0,capture:!1},window.addEventListener("mousedown",f.handleEvent,f.passive),window.addEventListener("mouseup",f.handleEvent,f.passive),window.addEventListener("mousemove",f.handleEvent,f.passive),window.addEventListener("touchmove",f.handleEvent,f.passive),window.addEventListener("touchcancel",f.handleEvent,f.passive),window.addEventListener("touchend",f.handleEvent,f.passive),window.addEventListener("touchstart",f.handleEvent,f.passive)};m=()=>(f||(f={mobile:p(),passiveSupported:!1,animations:[],listeners:{mousedown:[],mouseup:[],mousemove:[],touchmove:[],touchcancel:[],touchend:[],touchstart:[]},handleEvent:e=>{f.listeners[e.type].forEach(t=>t(e))},addEventListener:(e,t)=>{f.listeners[e].push(t)},removeEventListener:(e,t)=>{f.listeners[e]=f.listeners[e].filter(e=>e!==t)},registerAnimation:e=>(f.animations.push(e),1===f.animations.length&&window.requestAnimationFrame(f.render),e),cancelAnimation:e=>(f.animations=f.animations.filter(t=>t!==e),null),render:e=>{// collect components that requires repainting
    let t=[],i=!1;// run animations, filter finished ones
    f.animations=f.animations.filter(a=>(t.push(a.draw),i=i||a.force,!!a.update&&a.update(e)));// TODO: very ugly, rethink
    let a=[];// let count = 0;
    t.forEach(e=>e.forEach(e=>{a.some(t=>t===e)||(a.push(e),e(i));// count += 1;
        })),f.animations.length&&window.requestAnimationFrame(f.render)}},u()),f);var g={};let x=[1/0,-1/0],y=e=>!(e<1)&&(e&e-1)==0,v=e=>{if(y(e))return 2*e-1;let t=Math.floor(Math.log2(e));return 2*2**(t+1)-1},b=e=>2*e+1,E=e=>2*e+2,k=(e,t,i,a,l)=>{if(i===a)return e[l]=[t[i],t[i]],e;let n=Math.floor((i+a)/2);k(e,t,i,n,b(l)),k(e,t,n+1,a,E(l));let o=e[b(l)],r=e[E(l)];return e[l]=[Math.min(o[0],r[0]),Math.max(o[1],r[1])],e},X=(e,t,i,a,l,n)=>{if(t<=a&&i>=l)return e[n];if(t>l||i<a)return x;let o=Math.floor((a+l)/2),r=X(e,t,i,a,o,b(n)),d=X(e,t,i,o+1,l,E(n));return[Math.min(r[0],d[0]),Math.max(r[1],d[1])]};n=e=>{let t=e.length,i=v(t),a=Array(i).fill(null);return[k(a,e,0,t-1,0),e.length]},o=(e,t,i)=>X(e[0],t,i,0,e[1]-1,0);// const PREFERED_STEPS = [1, 1.5, 2, 2.5, 5, 7.5, 10];
// const findScale = (min, max, count) => {
//   const range = max - min;
//   const roughStep = range / (count - 1);
//   const stepPower = Math.pow(10, -Math.floor(Math.log10(Math.abs(roughStep))));
//   const normalizedStep = roughStep * stepPower;
//   const preferedStep = PREFERED_STEPS.find(v => v >= normalizedStep);
//   const step = Math.round(preferedStep / stepPower);
//   const bot = Math.floor(min / step) * step;
//   const top = Math.ceil(max / step) * step;
//   return [bot, top - bot, top, step];
// };
let C=(e,t,i)=>{let a=(t-e)/i,l=10**Math.floor(Math.log10(Math.abs(a))),n=a/l*10,o=Math.max(n,5*Math.ceil(n/5))/10*l,r=e+o*i;return[e,r-e,r,o]},A=(e,t,i)=>e.ids.reduce((a,l)=>{let n=e.charts[l];if(n.disabled)return a;let r=o(n.mmtree,t,i);return a[0]=Math.min(a[0],r[0]),a[1]=Math.max(a[1],r[1]),a},[1/0,-1/0]),D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Y=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];e=(e,t)=>{let i=new Date(e),a=i.getDate(),l=i.getMonth();return"short"===t?`${D[l]} ${a>9?a:`0${a}`}`:"date"===t?`${a} ${D[l]} ${i.getFullYear()}`:`${Y[i.getDay()]}, ${a>9?a:`0${a}`} ${D[l]} ${i.getFullYear()}`},t=(e,t,i)=>{let a=e.grid.lines;if(e.percentage)return C(0,100,a);if(e.stacked){let l=o(e.y.mmtree,t,i);return C(0,l[1],a)}if(e.y_scaled){let l=o(e.charts[e.ids[0]].mmtree,t,i),n=C(l[0],l[1],a),r=o(e.charts[e.ids[1]].mmtree,t,i),d=C(r[0],r[1],a);return[n,d]}let l=A(e,t,i),n=e.ids.every(t=>"bar"===e.charts[t].type);if(n){let e=l[0]-(l[1]-l[0])*.05;// preserve sign
if(Math.sign(l[0])===Math.sign(l[1]))return C(e,l[1],a)}return C(l[0],l[1],a)},i=e=>{let t=e.x.values.length,i=Array(t),a=e.ids.length;for(let l=0;l<t;l++){let t=0;for(let i=0;i<a;i++){let a=e.charts[e.ids[i]];a.disabled||(t+=a.values[l])}i[l]=t}return i},a=(e,t,i)=>Math.max(Math.min(e,i),t),l=e=>{let t=window.devicePixelRatio,i=Math.floor(e.clientWidth*t),a=Math.floor(e.clientHeight*t);return(e.width!==i||e.height!==a)&&(e.width=i,e.height=a,!0)};var M=(e,t)=>Math.max(Math.min(Math.round((e-1)*t),e-1),0);let T=(e,t)=>e.find(e=>e[0]===t).slice(1),L=(e,t)=>e.reduce((e,i)=>{let a=T(t.columns,i);return e[i]={id:i,name:t.names[i],type:t.types[i],color:{hex:t.colors[i],alpha:1},disabled:!1,values:a},e},{});g=e=>{let a=Object.keys(e.names),l=T(e.columns,"x"),o=L(a,e),r=M(l.length,.6),d=M(l.length,.3),s={ids:a,charts:o,y_scaled:!!e.y_scaled,stacked:!!e.stacked,percentage:!!e.percentage,x:{values:l,matrix:[0,l.length-1]},y:{lineWidth:1,matrix:[-1,-1,-1]},y0:{lineWidth:2,matrix:[-1,-1,-1]},window:{offset:r,width:d,minwidth:M(l.length,.08),tracker:{width:10,stroke:{hex:"#C0D1E1",alpha:1},color:{hex:"#C0D1E1",alpha:1}},mask:{color:{hex:"#E2EEF9",alpha:.6}}},tooltip:{lineWidth:1,lighten:!0,color:{hex:"#182D3B",alpha:.1},radius:3,index:null},grid:{lines:5,lineWidth:1,color:{hex:"#182D3B",alpha:.1}},axis:{x:{font:"Arial",size:10,color:{hex:"#8E8E93",alpha:1}},y:{font:"Arial",size:10,color:{hex:"#8E8E93",alpha:1}}}};return e.percentage?s.y.sum=i(s):e.stacked?(s.y.sum=i(s),s.y.mmtree=n(s.y.sum)):a.forEach(e=>{let t=o[e];t.mmtree=n(t.values)}),s.y.matrix=t(s,0,l.length),s.y0.matrix=t(s,r,r+d),s};var _={},R=e=>{let t=Math.abs(e);return t>999999999?(e/1e9).toFixed(2)+"B":t>999999?(e/1e6).toFixed(2)+"M":t>999?(e/1e3).toFixed(1)+"K":e.toFixed(0)},S={};S=(e,t,i,a)=>{let{chart:l,text:n}=i;if(i.mode&(a.FORCE|a.XBOUNDS)){i.mode|=a.TEXT;let t=l.range/n.steps,o=Math.log2(t/n.minstep),r=0|o;n.fraction=o%1,n.power!==r&&(n.power=0|r,n.step=2**Math.floor(n.power)*Math.ceil(n.minstep),n.doublestep=Math.ceil(2*n.step));let d=Math.ceil(l.start/n.step)*n.step-n.step;n.start=Math.max(d,n.step)-n.padding,n.last=Math.min(l.start+l.range+1,e.x.values.length)}if(i.mode&(a.TEXT|a.FORCE)){t.clearRect(n.region.x,n.region.y,n.region.width,n.region.height);let a=e.axis.x.color.alpha;t.font=n.font,t.fillStyle=e.axis.x.color.hex,t.globalAlpha=a,t.textBaseline="top",t.textAlign="center";for(let a=-n.padding;a<n.last;a+=n.doublestep){if(a<n.start)continue;let o=a-l.start;t.fillText(i.formatX(e.x.values[a],"short"),o*l.scaleX+l.offsetX,n.y)}t.globalAlpha=a*(1-n.fraction);for(let a=n.step-n.padding;a<n.last;a+=n.doublestep){if(a<n.start)continue;let o=a-l.start;t.fillText(i.formatX(e.x.values[a],"short"),o*l.scaleX+l.offsetX,n.y)}}};var N={};let O=(e,t,i,a,l,n)=>{let o=n.sum[t],r=l.height*(i/o)*a,d=l.y+l.height-r;if(n.stacked){let e=n.first?0:n.stack[t];d-=e,n.stack[t]=e+r}e[0]=d,e[1]=r;// return result;
},$=(e,t,i,a,l,n)=>{// TODO: improve
let o=n.sum[t],r=o/n.matrix[2],d=n.first?0:n.stack[t],s=l.y+l.height*(1-r),h=l.height*r,c=h*(i/o)*a;n.stack[t]=d+c,e[0]=s+d,e[1]=c;// return result;
},W=(e,t,i)=>{let a=i.y+t*i.scaleY+i.offsetY,l=i.height-a+i.y;e[0]=a,e[1]=l;// return result;
};r=(e,t,i,a)=>{let l=e.globalAlpha,n=[,,];if(e.beginPath(),!a.first&&a.stacked)for(let t=i.range;t>=0;t--){let l=i.start+t,n=i.x+t*i.scaleX+i.offsetX,o=i.y+i.height-a.stack[l];e.lineTo(n,o)}for(let o=0;o<=i.range;o+=1){let r=i.start+o,d=i.x+o*i.scaleX+i.offsetX;if(a.percentage?O(n,r,t[r],l,i,a):a.stacked?$(n,r,t[r],l,i,a):W(n,t[r],i),i.limit.bottom){let e=n[0];n[0]=e<i.limit.bottom?e:i.limit.bottom}e.lineTo(d,n[0])}(a.first||!a.stacked)&&(e.lineTo(i.width,i.y+i.height),e.lineTo(i.x,i.y+i.height)),e.fill()},d=(e,t,i,a,l)=>{let n=e.globalAlpha;e.beginPath();let o=i.range+1,r=[,,];for(let a=0;a<=o;a+=1){let o=i.start+a,d=i.x+a*i.scaleX+i.offsetX;if(l.percentage?O(r,o,t[o],n,i,l):l.stacked?$(r,o,t[o],n,i,l):W(r,t[o],i),i.limit.bottom){let e=r[0];r[0]=e<i.limit.bottom?e:i.limit.bottom}e.lineTo(d,r[0])}e.stroke()},s=(e,t,i,a,l)=>{let n=e.fillStyle,o=e.globalAlpha,r=a.tooltip.indexD;null!=r&&(e.fillStyle=l),e.beginPath();let d=i.range+1,s=[,,];for(let l=0;l<=d;l+=1){let n=i.start+l;if(n===r)continue;let d=i.x+l*i.scaleX+i.offsetX-i.scaleX/2,h=i.scaleX;a.percentage?O(s,n,t[n],o,i,a):a.stacked?$(s,n,t[n],o,i,a):W(s,t[n],i),e.rect(d,s[0],h,s[1])}if(e.fill(),null!=r){let l=r-i.start,d=i.x+l*i.scaleX+i.offsetX-i.scaleX/2,h=i.scaleX;a.percentage?O(s,r,t[r],o,i,a):a.stacked?$(s,r,t[r],o,i,a):W(s,t[r],i),e.fillStyle=n,e.fillRect(d,s[0],h,s[1])}};var F=(e,t,i)=>{e.beginPath();let a=-i.height/t;for(let l=0;l<t;l+=1){let t=i.y+l*a+i.height;e.moveTo(i.x,t),e.lineTo(i.width,t)}e.stroke()},z=(e,t,i,a,l)=>{let n=(t[2]-t[3]|0)+1;for(let o=t[0];o<=n;o+=t[3])e.fillText(l(o,"short"),i,a.y+o*a.scaleY+a.offsetY)},P=(e,t,i)=>{e.beginPath(),e.moveTo(t,i.region.y),e.lineTo(t,i.height),e.stroke()},H=(e,t,i,a,l)=>{e.beginPath(),e.arc(t,i,a,0,2*Math.PI),e.stroke();let n=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",e.beginPath(),e.arc(t,i,a-(.5+l/2|0),0,2*Math.PI),e.fill(),e.globalCompositeOperation=n};N=(e,t,i,a)=>{let{previousState:l,chart:n,grid:o,tooltip:h}=i;if(e.y_scaled?(l.y0.matrix||(l.y0.matrix=[[-1,-1],[-1,-1]]),(i.mode&a.FORCE||l.y0.matrix[0][0]!==e.y0.matrix[0][0]||l.y0.matrix[0][1]!==e.y0.matrix[0][1])&&(i.mode|=a.CHART,l.y0.matrix[0][0]=e.y0.matrix[0][0],l.y0.matrix[0][1]=e.y0.matrix[0][1],n.scaleY0=-n.height/e.y0.matrix[0][1],n.offsetY0=n.height-e.y0.matrix[0][0]*n.scaleY0),(i.mode&a.FORCE||l.y0.matrix[1][0]!==e.y0.matrix[1][0]||l.y0.matrix[1][1]!==e.y0.matrix[1][1])&&(i.mode|=a.CHART,l.y0.matrix[1][0]=e.y0.matrix[1][0],l.y0.matrix[1][1]=e.y0.matrix[1][1],n.scaleY1=-n.height/e.y0.matrix[1][1],n.offsetY1=n.height-e.y0.matrix[1][0]*n.scaleY1)):(l.y0.matrix||(l.y0.matrix=[-1,-1]),(i.mode&a.FORCE||l.y0.matrix[0]!==e.y0.matrix[0]||l.y0.matrix[1]!==e.y0.matrix[1])&&(i.mode|=a.CHART,l.y0.matrix[0]=e.y0.matrix[0],l.y0.matrix[1]=e.y0.matrix[1],n.scaleY=-n.height/e.y0.matrix[1],n.offsetY=n.height-e.y0.matrix[0]*n.scaleY)),i.mode&(a.CHART|a.FORCE)){t.clearRect(n.region.x,n.region.y,n.region.width,n.region.height),i.first=!0,t.lineJoin="bevel",t.lineCap="butt",t.lineWidth=n.lineWidth;for(let a=0;a<e.ids.length;a++){let l=e.ids[a],o=e.charts[l];0!==o.color.alpha&&(e.y_scaled&&a>1||(e.y_scaled&&(// TODO: scaleY1 for last only
n.scaleY=n[`scaleY${a}`],n.offsetY=n[`offsetY${a}`]),t.globalAlpha=o.color.alpha,t.strokeStyle=o.color.hex,t.fillStyle=o.color.hex,"line"===o.type&&d(t,o.values,n,"line"===o.type,i),"area"===o.type&&r(t,o.values,n,i,o.alpha),"bar"===o.type&&s(t,o.values,n,i,i.lighten[l]),i.first=!1))}if(t.lineWidth=o.lineWidth,t.globalAlpha=e.grid.color.alpha,t.strokeStyle=e.grid.color.hex,F(t,e.grid.lines,n),null!==h.x&&!i.bar){t.lineWidth=h.lineWidth,t.globalAlpha=e.tooltip.color.alpha,t.strokeStyle=e.tooltip.color.hex,P(t,h.x,n),t.lineWidth=n.lineWidth;for(let i=0;i<e.ids.length;i++){let a=e.ids[i],l=e.charts[a];if(0===l.color.alpha||"area"===l.type||e.y_scaled&&i>1)continue;e.y_scaled&&(// TODO: scaleY1 for last only
n.scaleY=n[`scaleY${i}`],n.offsetY=n[`offsetY${i}`]),t.globalAlpha=l.color.alpha,t.strokeStyle=l.color.hex;let o=n.y+l.values[h.indexD]*n.scaleY+n.offsetY;H(t,h.xD,o,h.radius,n.lineWidth)}}if(t.font=o.font,t.textBaseline="bottom",e.y_scaled){let a=e.charts[e.ids[0]].color;t.fillStyle=a.hex,t.globalAlpha=a.alpha,t.textAlign="start",n.scaleY=n.scaleY0,n.offsetY=n.offsetY0,z(t,e.y0.matrix[0],0,n,i.formatY);let l=e.charts[e.ids[1]].color;t.fillStyle=l.hex,t.globalAlpha=l.alpha,t.textAlign="end",n.scaleY=n.scaleY1,n.offsetY=n.offsetY1,z(t,e.y0.matrix[1],n.width,n,i.formatY)}else t.fillStyle=e.axis.y.color.hex,t.globalAlpha=e.axis.y.color.alpha,t.textAlign="start",// TODO: pass formated values
z(t,e.y0.matrix,0,n,i.formatY)}};let j=e=>{let t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),a=parseInt(e.substring(5,7),16);return`#${(t+(255-t)/3|0).toString(16)}${(i+(255-i)/3|0).toString(16)}${(a+(255-a)/3|0).toString(16)}`},B=e=>{let t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),a=parseInt(e.substring(5,7),16);return`#${(t-t/3|0).toString(16)}${(i-i/3|0).toString(16)}${(a-a/3|0).toString(16)}`},I={NONE:0,FORCE:1,XBOUNDS:2,CHART:4,TEXT:8};_=(t,i)=>{let a=document.createElement("div");a.className="tc-chart-wrapper";let n=document.createElement("canvas");n.className="tc-chart",a.appendChild(n);let o=n.getContext("2d"),r={},d={},s={},h={},c={charts:{},window:{},tooltip:{},y0:{}},m={mode:I.NONE,chart:r,text:d,grid:s,tooltip:h,previousState:c},f={};return{element:a,register:e=>e({id:"view",element:a,canvas:n,bounds:f}),render:a=>{if(m.mode=I.NONE,m.sum=t.y.sum,m.matrix=t.y0.matrix,a){m.mode|=I.FORCE,l(n);// update element positions
let a=n.getBoundingClientRect();f.left=a.left+window.pageXOffset,f.top=a.top+window.pageYOffset,f.right=a.right+window.pageXOffset,f.bottom=a.bottom+window.pageYOffset;let c=window.devicePixelRatio;// value formatters
m.formatX=i&&i.formatX||e,m.formatY=i&&i.formatY||R,m.stacked=t.stacked,m.percentage=t.percentage,t.stacked&&(m.stack=Array(t.x.values.length));// text
let p=(t.axis.x.size||10)*c;d.font=`${p}px ${t.axis.x.font}`,d.height=p+4*c,d.width=n.width,d.x=0,d.y=n.height-d.height+2*c,o.font=d.font;let w=Math.ceil(o.measureText(m.formatX(t.x.values[0],"short")).width);d.steps=Math.max(n.width/(2*w),1),d.minstep=(t.window.minwidth-1)/d.steps,d.padding=Math.floor(d.minstep/2),d.region={x:0,y:n.height-d.height,width:n.width,height:p+4*c},// grid lines
s.lineWidth=t.grid.lineWidth*c,s.font=`${(t.axis.y.size||10)*c}px ${t.axis.y.font}`,// tooltip point and line
h.lineWidth=t.tooltip.lineWidth*c,h.radius=t.tooltip.radius*c,// chart
r.lineWidth=t.y0.lineWidth*c,r.width=n.width,r.height=n.height-d.height-(h.radius+4),r.x=0,r.y=0,r.region={x:0,y:0,width:n.width,height:n.height-d.height},r.limit={bottom:r.height};// some props based on charts provided
let u=t.tooltip.lighten?j:B;m.lighten={},m.bar=!1;for(let e=0;e<t.ids.length;e++){let i=t.ids[e],a=t.charts[i];u?m.lighten[i]=u(a.color.hex):m.lighten[i]=j(a.color.hex),m.bar=m.bar||"bar"===a.type}}(m.mode&I.FORCE||c.window.offset!==t.window.offset||c.window.width!==t.window.width)&&(m.mode|=I.XBOUNDS|I.CHART|I.TEXT,c.window.offset=t.window.offset,c.window.width=t.window.width,r.start=0|t.window.offset,r.range=0|t.window.width,m.bar?(r.scaleX=r.width/(r.range+t.window.width-r.range),r.offsetX=-r.scaleX*(t.window.offset-r.start)+r.scaleX/2):(r.scaleX=r.width/(r.range-1+t.window.width-r.range),r.offsetX=-r.scaleX*(t.window.offset-r.start))),(m.mode&(I.FORCE|I.XBOUNDS)||c.tooltip.index!==t.tooltip.index)&&(m.mode|=I.CHART,c.tooltip.index=t.tooltip.index,null!==t.tooltip.index?(h.indexD=Math.min(r.start+t.tooltip.indexD,t.x.values.length-1),h.xD=r.x+(h.indexD-r.start)*r.scaleX+r.offsetX,h.x=r.x+t.tooltip.index*r.scaleX+r.offsetX):(h.xD=null,h.indexD=null,h.x=null));// update chart colors
for(let e=0;e<t.ids.length;e++){let i=t.ids[e];i in c.charts||(c.charts[i]={color:{}});let a=t.charts[i].color,l=c.charts[i].color;(l.hex!==a.hex||l.alpha!==a.alpha)&&(l.hex=a.hex,l.alpha=a.alpha,m.mode|=I.CHART)}// if (state.y_scaled) {
//   handleScaledLineChart(state, context, cache, MODE);
// } else {
N(t,o,m,I),// }
S(t,o,m,I)}}};var q={},J=(e,t,i,a,l,n)=>{e.beginPath(),e.moveTo(t-i+l*n,0),e.arcTo(t-i,0,t-i,l,l),e.lineTo(t-i,a-l),e.arcTo(t-i,a,t-i+l*n,a,l),e.lineTo(t,a),e.lineTo(t,0),// const clipWidth = Math.floor(width * 0.3);
// const clipRaduis = Math.floor(clipWidth / 2);
// const clipHeight = Math.floor(height * 0.3);
// const clipX = Math.floor(width / 2 + clipWidth / 2);
// const clipY = Math.floor(height / 2 - clipHeight / 2 + clipRaduis);
// context.moveTo(clipX, clipY);
// context.arcTo(
//   width / 2,
//   clipY - clipRaduis,
//   clipX - clipWidth,
//   clipY,
//   clipRaduis
// );
// context.lineTo(clipX - clipWidth, clipY + clipHeight - clipRaduis);
// context.arcTo(
//   width / 2,
//   clipY + clipHeight,
//   clipX,
//   clipY + clipHeight - clipRaduis,
//   clipRaduis
// );
// context.closePath();
e.fill()};q=e=>{let t=document.createElement("canvas");t.className="tc-preview";let i=t.getContext("2d"),a={},n={},o={charts:{},y:{},window:{}},h={tooltip:{},chart:a,track:n,state:o},c={};return{element:t,render:m=>{let f=m;if(h.sum=e.y.sum,h.matrix=e.y.matrix,m){l(t);// update element positions
let i=t.getBoundingClientRect();c.left=i.left+window.pageXOffset,c.top=i.top+window.pageYOffset,c.right=i.right+window.pageXOffset,c.bottom=i.bottom+window.pageYOffset;let o=window.devicePixelRatio;h.stacked=e.stacked,h.percentage=e.percentage,e.stacked&&(h.stack=Array(e.x.values.length)),// track
n.padding=1*o,n.borderRadius=5*o,n.width=(e.window.tracker.width||10)*o,n.height=t.height,// chart
a.lineWidth=e.y.lineWidth*o,a.width=t.width,a.height=t.height-2*n.padding,a.x=0,a.y=n.padding,a.region={x:0,y:0,width:t.width,height:t.height},a.start=0,a.range=e.x.values.length-1,a.scaleX=t.width/a.range,a.offsetX=0,a.limit={}}// update chart colors
for(let t=0;t<e.ids.length;t++){let i=e.ids[t];i in o.charts||(o.charts[i]={color:{}});let a=e.charts[i].color,l=o.charts[i].color;(l.hex!==a.hex||l.alpha!==a.alpha)&&(l.hex=a.hex,l.alpha=a.alpha,f=!0)}if((m||o.window.offset!==e.window.offset||o.window.width!==e.window.width)&&(o.window.offset=e.window.offset,o.window.width=e.window.width,n.left=e.window.offset*a.scaleX+n.width,n.right=(e.window.offset+e.window.width-1)*a.scaleX-n.width,f=!0),e.y_scaled?(o.y.matrix||(o.y.matrix=[[-1,-1],[-1,-1]]),(m||o.y.matrix[0][0]!==e.y.matrix[0][0]||o.y.matrix[0][1]!==e.y.matrix[0][1])&&(o.y.matrix[0][0]=e.y.matrix[0][0],o.y.matrix[0][1]=e.y.matrix[0][1],a.scaleY0=-a.height/e.y.matrix[0][1],a.offsetY0=a.height-e.y.matrix[0][0]*a.scaleY0,f=!0),(m||o.y.matrix[1][0]!==e.y.matrix[1][0]||o.y.matrix[1][1]!==e.y.matrix[1][1])&&(o.y.matrix[1][0]=e.y.matrix[1][0],o.y.matrix[1][1]=e.y.matrix[1][1],a.scaleY1=-a.height/e.y.matrix[1][1],a.offsetY1=a.height-e.y.matrix[1][0]*a.scaleY1,f=!0)):(o.y.matrix||(o.y.matrix=[-1,-1]),(m||o.y.matrix[0]!==e.y.matrix[0]||o.y.matrix[1]!==e.y.matrix[1])&&(o.y.matrix[0]=e.y.matrix[0],o.y.matrix[1]=e.y.matrix[1],a.scaleY=-a.height/e.y.matrix[1],a.offsetY=a.height-e.y.matrix[0]*a.scaleY,f=!0)),f){i.clearRect(a.region.x,a.region.y,a.region.width,a.region.height),h.first=!0,i.lineJoin="bevel",i.lineCap="butt",i.lineWidth=a.lineWidth;for(let t=0;t<e.ids.length;t++){let l=e.ids[t],n=e.charts[l];0!==n.color.alpha&&(e.y_scaled&&t>1||(e.y_scaled&&(a.scaleY=a[`scaleY${t}`],a.offsetY=a[`offsetY${t}`]),i.globalAlpha=n.color.alpha,i.strokeStyle=n.color.hex,i.fillStyle=n.color.hex,"line"===n.type&&d(i,n.values,a,"line"===n.type,h),"bar"===n.type&&s(i,n.values,a,h),"area"===n.type&&r(i,n.values,a,h),h.first=!1))}i.globalAlpha=e.window.mask.color.alpha,i.fillStyle=e.window.mask.color.hex,i.fillRect(a.x,a.y,n.left,a.height),n.right!==a.region.width&&i.fillRect(n.right,a.y,a.width-n.right,a.height),i.globalAlpha=e.window.tracker.color.alpha,i.fillStyle=e.window.tracker.color.hex,J(i,n.left,n.width,n.height,n.borderRadius,1),J(i,n.right,-n.width,n.height,n.borderRadius,-1),i.fillRect(n.left,0,n.right-n.left,n.padding),i.fillRect(n.left,a.region.height-n.padding,n.right-n.left,n.padding)}},register:e=>e({id:"preview",element:t,bounds:c})}};var U={};let Z=e=>{let t=document.createElement("div");t.className="tc-checkbox",t.style.backgroundColor=e.color.hex;let i=document.createElement("div");return i.appendChild(t),i.appendChild(document.createTextNode(e.name)),i.className="tc-control tc-checked",{id:e.id,element:i}};U=e=>{if(e.ids.length<2)return{element:null,render:()=>{},register:()=>{}};let t=document.createElement("div");t.className="tc-controls";let i=e.ids.map(i=>{let a=Z(e.charts[i]);return t.appendChild(a.element),a});return{element:t,render:()=>{},register:e=>e({element:t,controls:i})}};var K={};let V=e=>{let t=document.createElement("div");t.className="tc-tooltip__value tc-tooltip__value--hidden";let i=document.createElement("span"),a=document.createElement("span");t.appendChild(i.appendChild(document.createTextNode("All"))),t.appendChild(a);let l={};return{element:t,render:(i,n)=>{(i||l.stacked!==e.stacked)&&(l.stacked=e.stacked,e.stacked?t.classList.remove("tc-tooltip__value--hidden"):t.classList.add("tc-tooltip__value--hidden")),e.stacked&&(i||l.index!==n)&&(l.index=n,n&&(a.textContent=e.y.sum[n]))}}},G=e=>{let t=document.createElement("div");t.className="tc-tooltip__value";let i=document.createElement("span"),a=document.createElement("span");a.style.color=e.color.hex,t.appendChild(i.appendChild(document.createTextNode(e.name))),t.appendChild(a);let l={};return{id:e.id,element:t,render:(i,n)=>{(i||l.disabled!==e.disabled)&&(l.disabled=e.disabled,e.disabled?t.classList.add("tc-tooltip__value--hidden"):t.classList.remove("tc-tooltip__value--hidden")),(i||l.index!==n)&&(l.index=n,null!=n&&(a.textContent=e.values[n]))}}};K=(t,i)=>{let l=document.createElement("div");l.className="tc-tooltip tc-tooltip--hidden";let n=document.createElement("div");n.className="tc-tooltip__value";let o=document.createElement("div");o.className="tc-tooltip__name";let r=document.createElement("div");r.className="tc-tooltip__arrow",n.appendChild(o),n.appendChild(r);let d=document.createElement("div");d.className="tc-tooltip__wrapper";let s=t.ids.map(e=>{let i=G(t.charts[e]);return d.appendChild(i.element),i}),h=V(t);d.appendChild(h.element),l.appendChild(n),l.appendChild(d);let c={tooltip:{}},m={};return{element:l,register:e=>e({id:"tooltip",element:l}),render:n=>{n&&(m.formatX=i&&i.formatX||e);let r=t.tooltip.indexD||0===t.tooltip.indexD;if((n||m.visible!==r)&&(m.visible=r,r?l.classList.remove("tc-tooltip--hidden"):l.classList.add("tc-tooltip--hidden")),(n||c.tooltip.indexD!==t.tooltip.indexD)&&(c.tooltip.indexD=t.tooltip.indexD,r)){l.style.transform=`translateX(${t.tooltip.indexX-20}px)`;let e=null!=t.window.offsetD?t.window.offsetD:0|t.window.offset,i=a(e+t.tooltip.indexD,0,t.x.values.length-1);o.textContent=m.formatX(t.x.values[i],"full"),s.forEach(e=>e.render(n,i)),h.render(n,i)}}}};var Q={};Q=(t,i)=>{let a=document.createElement("div");a.className="tc-range";let l=document.createElement("div"),n=document.createElement("div");a.appendChild(l),a.appendChild(document.createTextNode(" - ")),a.appendChild(n);let o={window:{}},r={};return{element:a,render:a=>{let d=void 0===t.window.offsetD?0|t.window.offset:t.window.offsetD,s=void 0===t.window.widthD?0|t.window.width:t.window.widthD;a&&(r.formatX=i&&i.formatX||e),(a||o.window.widthD!==s||o.window.offsetD!==d)&&(o.window.widthD=s,o.window.offsetD=d,l.textContent=r.formatX(t.x.values[d],"date"),n.textContent=r.formatX(t.x.values[d+s-1],"date"))},register:()=>{}}};var ee={};let et=e=>e,ei=(e,t,i,a)=>Array.isArray(t)?(t.forEach((t,l)=>{e[l]=ei(e[l],t,i[l],a)}),e):"object"==typeof t?Object.keys(t).reduce((l,n)=>(l[n]=ei(e[n],t[n],i[n],a),l),e):"boolean"==typeof t?1===a?i:t:t+(i-t)*a,ea=e=>Array.isArray(e)?e.map(e=>ea(e)):"object"==typeof e?Object.keys(e).reduce((t,i)=>(t[i]=ea(e[i]),t),{}):e;h=(e,t,i,a)=>{let l=Object.assign({delay:0,duration:300,start:null,easing:et,onFinish:null},a),n=ea(e);return o=>{if(!l.start)return l.start=o,!0;let r=o-l.start;if(r<l.delay)return!0;let d=r>=l.duration,s=d?1:Math.min(Math.max(l.easing(r/l.duration),0),1),h=ei(n,e,t,s);return i(h),d&&a.onFinish&&a.onFinish(h),!1===d}};var el=e=>e<.5?2*e*e:-1+(4-2*e)*e,en=(e,a)=>{let l=[];e.stacked&&(l=i(e),e.percentage||(e.y.mmtree=n(l)));let o=t(e,0,e.x.values.length),r=t(e,e.window.offset,e.window.offset+e.window.width),d=e.ids.reduce((t,i)=>(t[i]=e.charts[i].color.alpha,t),{}),s=e.ids.reduce((t,i)=>(t[i]=e.charts[i].disabled?0:1,t),{}),c=h({sum:e.y.sum||[],alpha:d,y:e.y.matrix,y0:e.y0.matrix},{sum:l,alpha:s,y:o,y0:r},t=>{for(let i=0;i<e.ids.length;i++){let a=e.ids[i];e.charts[a].color.alpha=t.alpha[a]}e.y.matrix=t.y,e.y0.matrix=t.y0,e.stacked&&(e.y.sum=t.sum)},{duration:500,easing:el});return{draw:a,update:c}};let eo=e=>e.ids.reduce((t,i)=>t+(e.charts[i].disabled?0:1),0);ee=(e,t,i)=>a=>{let l=null,n=a=>{let n=e.charts[a.id],o=eo(e);if(!n.disabled&&o<2){a.element.classList.add("apply-shake");return}t.cancelAnimation(l),n.disabled=!n.disabled,n.disabled?a.element.classList.remove("tc-checked"):a.element.classList.add("tc-checked"),l=t.registerAnimation(en(e,i))},o=n=>{t.cancelAnimation(l);let o=e.charts[n.id],r=eo(e);!o.disabled&&r<2?(// check all when long pressing single checked filter
    e.ids.forEach(t=>{e.charts[t].disabled=!1}),a.controls.forEach(e=>{e.element.classList.add("tc-checked")}),l=t.registerAnimation(en(e,i,!0))):(e.ids.forEach(t=>{e.charts[t].disabled=t!==n.id}),a.controls.forEach(e=>{e!==n?e.element.classList.remove("tc-checked"):e.element.classList.add("tc-checked")}),l=t.registerAnimation(en(e,i)))},r=null,d=e=>{clearTimeout(r),r=setTimeout(()=>{o(e),r=null},1e3)},s=e=>{r&&(clearTimeout(r),n(e))};a.controls.forEach(e=>{e.element.addEventListener("animationend",()=>{e.element.classList.remove("apply-shake")}),e.element.addEventListener("touchstart",()=>{d(e)},t.passive),e.element.addEventListener("touchend",t=>{t.preventDefault(),s(e)}),e.element.addEventListener("touchcancel",t=>{t.preventDefault(),s(e)}),e.element.addEventListener("mousedown",()=>{d(e)},t.passive),e.element.addEventListener("mouseup",()=>{s(e)},t.passive)})};var er={},ed=(e,t,i)=>{let a=e.tooltip.indexD,l=null;return{draw:i,update:i=>{if(t.done)return e.tooltip.index=null,e.tooltip.indexD=null,!1;if(l){let e=l(i);e||(l=null)}let n=Math.max(Math.floor(t.offsetX*t.step),0);if(n!==a){let o=Math.round(n/t.step);null!==e.tooltip.index?l=h(e.tooltip.index,n,t=>{e.tooltip.index=t,e.tooltip.indexD=n,e.tooltip.indexX=o},{start:i,duration:150}):(e.tooltip.index=n,e.tooltip.indexD=n,e.tooltip.indexX=o),a=n}return!0}}};er=(e,t,i)=>a=>{let l=null,n=null,o=(a,o)=>{if(n||Number.isNaN(a))return;let r=e.window.widthD||0===e.window.widthD?e.window.widthD:0|e.window.width;n={offsetX:a,step:r/o,done:!1},t.cancelAnimation(l),l=t.registerAnimation(ed(e,n,i))},r=()=>{n&&(n.done=!0,n=null)},d=e=>{n&&(n.offsetX=e)};t.addEventListener("mousemove",e=>{if(e.target!==a.canvas)return;let t=e.pageX-a.bounds.left;n?d(t):o(t,a.bounds.right-a.bounds.left)}),t.addEventListener("touchstart",e=>{if(e.target!==a.canvas)r();else{let t=e.targetTouches[0].pageX,i=t-a.bounds.left;n?d(i):o(i,a.bounds.right-a.bounds.left)}}),a.element.addEventListener("mouseenter",e=>{e.target===a.canvas&&o(e.pageX-a.bounds.left,a.bounds.right-a.bounds.left)},t.passive),a.element.addEventListener("mouseleave",e=>{r()},t.passive)};var es={},eh=e=>--e*e*e+1;let ec=(e,i,a,l)=>{let n=t(e,i,i+a);return h({offset:e.window.offset,width:e.window.width,y0:e.y0.matrix},{offset:i,width:a,y0:n},t=>{e.window.offset=t.offset,e.window.offsetD=i,e.window.width=t.width,e.window.widthD=a,e.y0.matrix=t.y0},{start:l,duration:300,easing:eh})},em=(e,t,i,l)=>{let n=t.width+i,o=a(n,e.window.minwidth,e.x.values.length),r=a(t.offset+n-o,0,e.x.values.length-o);return ec(e,r,o,l)},ef=(e,t,i,l)=>{let n=a(t.width-i,e.window.minwidth,e.x.values.length),o=a(t.offset+i,0,e.x.values.length-n);return ec(e,o,n,l)},ep=(e,t,i,l)=>{let n=a(t.offset+i,0,e.x.values.length-e.window.width);return ec(e,n,t.width,l)};var ew=(e,t,i)=>{let a={shift:0},l={offset:e.window.offset,width:e.window.width},n=null;return{draw:i,update:i=>{if(n){let e=n(i);e||(n=null)}let o=Math.ceil((t.pageX-t.initialPageX)*t.step);return o!==a.shift&&("drag"===t.type?n=ep(e,l,o,i):"resize-left"===t.type?n=ef(e,l,o,i):"resize-right"===t.type&&(n=em(e,l,o,i)),a.shift=o),null!==n||!t.done}}},eu=(e,i,a)=>{let l=t(e,i.offset,i.offset+i.width);return{draw:a,update:h({offset:e.window.offset,width:e.window.width,y0:e.y0.matrix},{offset:i.offset,width:i.width,y0:l},t=>{e.window.offset=t.offset,e.window.offsetD=i.offset,e.window.width=t.width,e.window.widthD=i.width,e.y0.matrix=t.y0},{duration:500,easing:eh})}};let eg=(e,t,i,a)=>{let l=i/(e.x.values.length-1),n=e.window.tracker.width*(a?3:1),o=e.window.offset*l-(a?e.window.tracker.width:0),r=(e.window.offset+e.window.width-1)*l+(a?e.window.tracker.width:0);return t<o||t>r?"scroll":t>o+n&&t<r-n?"drag":t>=o&&t<=o+n?"resize-left":"resize-right"};es=(e,t,i)=>l=>{// const listenerOptions = engine.passiveSupported ? { passive: true } : false;
    let n=null,o=null,r=(l,n)=>{let r;let d=n/e.x.values.length,s=eg(e,l,n);r="resize-left"===s?{offset:0,width:e.window.offset+e.window.width}:"resize-right"===s?{offset:e.window.offset,width:e.x.values.length-e.window.offset}:{offset:a(Math.round(l/d-e.window.minwidth/2),0,e.x.values.length-e.window.minwidth),width:e.window.minwidth},t.cancelAnimation(o),o=t.registerAnimation(eu(e,r,i))},d=(a,l,r)=>{n||(n={type:eg(e,a,r,t.mobile),initialPageX:l,step:e.x.values.length/r,pageX:l,done:!1},t.cancelAnimation(o),o=t.registerAnimation(ew(e,n,i)))},s=e=>{null!==n&&(n.pageX=e)},h=()=>{n&&(n.done=!0,n=null)};l.element.addEventListener("mousedown",e=>{e.preventDefault(),d(e.pageX-l.bounds.left,e.pageX,l.bounds.right-l.bounds.left)},!1),l.element.addEventListener("touchstart",e=>{e.preventDefault();let t=e.targetTouches[0].pageX;d(t-l.bounds.left,t,l.bounds.right-l.bounds.left)},!1),l.element.addEventListener("dblclick",e=>{e.preventDefault(),r(e.pageX-l.bounds.left,l.bounds.right-l.bounds.left)},!1),l.element.addEventListener("touchstart",e=>{e.preventDefault();let t=e.targetTouches[0].pageX;d(t-l.bounds.left,t,l.bounds.right-l.bounds.left)},!1),t.addEventListener("mousemove",e=>{n&&s(e.pageX)}),t.addEventListener("touchmove",e=>{n&&s(e.targetTouches[0].pageX)}),t.addEventListener("mouseup",h),t.addEventListener("touchcancel",h),t.addEventListener("touchend",h);// v.element.addEventListener(
    //   "touchstart",
    //   e => {
    //     const rect = e.target.getBoundingClientRect();
    //     const offsetX = e.targetTouches[0].pageX - rect.left;
    //     handleStart(offsetX, e.target.width);
    //   },
    //   engine.passiveSupported ? { passive: true } : false
    // );
    // v.element.addEventListener("touchmove", e => {
    //   if (!animation) return;
    //   const rect = e.target.getBoundingClientRect();
    //   state.window.offsetX = e.targetTouches[0].pageX - rect.left;
    //   state.window.targetWidth = e.target.width;
    // });
    // v.element.addEventListener("mousemove", e => {
    //   if (!animation) return;
    //   state.window.offsetX = e.offsetX;
    //   state.window.targetWidth = e.target.width;
    // });
    // v.element.addEventListener("mouseleave", handleCancel);
    // v.element.addEventListener("mouseup", handleCancel);
    // v.element.addEventListener("touchcancel", handleCancel);
    // v.element.addEventListener("touchend", handleCancel);
    };var ex={};// const { createTooltipAnimation } = require("../animations/tooltip");
ex=(e,t,i,a)=>t=>{// let animation = null;
    t.element.addEventListener("click",()=>{e.zoomIn})};let ey=(e,t)=>{e.className="tc-wrapper",e.appendChild(t.range),e.appendChild(t.view),e.appendChild(t.preview),e.appendChild(t.controls)};(c={createEngine:m,createState:g,createView:_,createPreview:q,createControls:U,createTooltip:K,createRange:Q,createControlHandlers:ee,createTooltipHandler:er,createPreviewHandler:es,createZoomHandler:ex,mountDefault:ey}).default=function(e,t){/*
   * Engine handles rendering and initialized once on the page.
   */let i=m(),a=g(e),l={},n=K(a),o=_(a);// adds tooltip to view wrapper
// important for proper event handling
o.element.appendChild(n.element);let r=q(a),d=U(a),s=Q(a);// Handle click events for toggle
d.register(ee(a,i,[o.render,r.render])),// // Handle mouseover and click events for zooming and tooltip
o.register(er(a,i,[o.render,n.render])),// Handle mouse and touch events for preview interactions
r.register(es(a,i,[o.render,r.render,s.render])),n.register(ex(l,a,i,[]));let h={view:o,controls:d,preview:r,tooltip:n,range:s},c={view:o.element,preview:r.element,controls:d.element,range:s.element},f=[o.render,r.render,s.render,n.render],p=(e,t)=>{t?f.forEach(t=>t(e)):i.registerAnimation({force:e,draw:f})};return(/*
   * API for chart
   */l.mount=e=>("function"==typeof e?e(c):ey(e,c),// Render all components for the first time
    p(!0,!1),l),l.update=e=>(e(i,a,h),l),l.render=(e,t)=>(p(e,t),l),l.onZoomIn=e=>(l.zoomIn=e,l),l)},window.telechart=c.default}();//# sourceMappingURL=telechart.min.js.map

//# sourceMappingURL=telechart.min.js.map
